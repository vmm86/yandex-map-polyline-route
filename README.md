# Вычисление маршрутов на Яндекс.Картах с помощью полилиний

Вычисление длины и стоимости произвольного маршрута, проходящего через несколько заданных точек.

## Описание

Для вычисления маршрута создаётся кастомная Яндекс.Карта на основе API 2.1.
Из элементов управления включены только масштабирование карты и отображение Яндекс.Пробок.

Тот или иной маршрут может проходить через несколько заранее заданных точек, хранящихся в двух ассоциативных массивах:

* **транзитные точки** - узловые точки, через которые должен проходить маршрут (транспортные развязки);

* **конечные точки** - конечные точки маршрута (населённые пункты).

Транзитные и конечные точки маршрута хранятся в свойствах объектов JavaScript в следующем формате: 

* *ключ* (строка) - уникальное человекопонятное название точки маршрута (например, `"развязка на Саратов"`), 

* *значение* (массив) - координаты точки маршрута с точностью до 4-х цифр после запятой (например, `[51.4963,39.5476]`).

При инициализации карты транзитные и конечные точки преобразуются в *балуны* (*плэйсмарки*) 
с координатами по их значениям и с подписями по их ключам в соответствующих объектах JavaScript.

## Принцип работы

Формирование искомого маршрута происходит при нажатии на любом из балунов.

При этом:

* редактируется *полилиния*, строящаяся между каждым из координат нажатых балунов;

* редактируется **список точек маршрута**, формирующийся из подписей нажатых балунов;

* подсчитывается **длина маршрута** как длина полилинии;

* подсчитывается **стоимость маршрута** как длина полилинии, умноженная на заданный коэффициент.

При нажатии на любом из ранее ненажатых балунов: 

* балун стилизуется как нажатый;

* к полилинии добавляется новая следующая по порядку вершина с координатами этого балуна;

* к списку точек маршрута добавляется новая следующая по порядку подпись этого балуна;

* пересчитывается и выводится длина маршрута и его стоимость.

При повторном нажатии на последнем из ранее нажатых балунов:

* балун стилизуется как ненажатый;

* из полилинии удаляется последняя по порядку вершина с координатами этого балуна;

* из списка точек маршрута удаляется последний по порядку элемент;

* пересчитывается и выводится длина маршрута и его стоимость.

Если маршрут проходил по одним и тем же точкам в обе стороны, нужно выделить флажок "маршрут туда и обратно" - 
маршрут и его стоимость будут умножены на 2, при снятии галочки - обратно разделены на 2.

Когда маршрут построен (т.е. когда выделены 2 и более точки), становится доступной кнопка *"Очистить маршрут"*, 
нажатие на которую сбрасывает вычисленные ранее показания и стилизацию всех ранее нажатых балунов.
